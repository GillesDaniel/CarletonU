define("dojo/_base/lang dojo/_base/declare dojo/dom-geometry dojo/dom dojo/dom-style dojo/dom-attr dojo/dom-class dojo/_base/window com/ibm/tivoli/maximo/miniapps/_MiniApp com/ibm/tivoli/maximo/miniapps/_MaximoLog com/ibm/tivoli/maximo/miniapps/Handlers".split(" "),function(d,e,f,k,l,m,n,p,g,c,h){return e([g,h],{TAG:"ACEEDITOR",SIZE:{w:800,h:500},constructor:function(a){this.options=a||{};c.debug("{} options",this.TAG,a)},startup:function(){this.inherited(arguments);this.loadLibrary(function(){return null!=
window.ace&&null!=window.ace.require},this.rootUrl+"/libraries/ace/ace.js",d.hitch(this,this.loadLangTools))},loadLangTools:function(){this.loadLibrary(function(){return window.ace.require("ace/ext/language_tools")},this.rootUrl+"/libraries/ace/ext-language_tools.js",d.hitch(this,this.createUI))},createUI:function(){var a=this;try{a.domNode.style.resize="both",(new ResizeObserver(function(b){a.invokeLater(function(){a.updateSize()},200,"_updatesize")})).observe(a.domNode)}catch(b){a.domNode.style.resize=
"",c.error("ResizeObserver not available")}this.editor=window.ace.edit(this.domNode,{theme:"ace/theme/chrome"});this.editor.setOptions({mode:"text",enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1,showInvisibles:!1,highlightSelectedWord:!0,fontSize:14});this.editor.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Cmd-S"},exec:function(b){a.updateSource()}});this.onMeasure()&&this.editor.resize(!0);this.getSource();this.editor.on("focus",function(b){console.log("got focus",
b);a.updateEditorMode()})},updateEditorMode:function(){this.fetch("getscripttype",{}).then(d.hitch(this,this.updateEditorModeFromResult))},updateEditorModeFromResult:function(a){c.debug("SCRIPT TYPE:",a);if(a&&a.sourceType){var b="text";0<=a.sourceType.toLowerCase().indexOf("ython")?b="python":0<=a.sourceType.toLowerCase().indexOf("rhino")?b="javascript":0<=a.sourceType.toLowerCase().indexOf("nash")?b="javascript":0<=a.sourceType.toLowerCase().indexOf("javascr")?b="javascript":0<=a.sourceType.toLowerCase().indexOf("ecma")?
b="javascript":0<=a.sourceType.toLowerCase().indexOf("js")?b="javascript":0<=a.sourceType.toLowerCase().indexOf("groovy")?b="groovy":0<=a.sourceType.toLowerCase().indexOf("mbr")?b="text":(b="text",c.debug("Using Text for ",a));this.editor.session.setMode("ace/mode/"+b)}},updateSize:function(){if(this.editor){var a=f.getContentBox(this.domNode);a&&(c.debug("resizing",a),this.editor.resize(!0),this.SIZE=a)}},getSource:function(){var a=this;this.fetch("getsource",{}).then(function(b){c.debug("SOURCE",
b);a._updateHandler&&a.editor.session.removeListener("change",a._updateHandler);b&&(a.editor.setValue(b.source),b.type&&a.updateEditorModeFromResult(b),a.editor.getSelection().clearSelection(),a.editor.session.getUndoManager().reset());a._updateHandler=d.hitch(a,a.updateSource);a.editor.session.on("change",a._updateHandler)})},updateSource:function(){var a=this;this.invokeLater(function(){a._updateSource()},200,"_updatesource")},_updateSource:function(){this.fetch("update",{source:this.editor.getValue()}).then(function(){c.debug("source updated");
saveUnlocked=!0;setButtonEnabled(saveButton,!0)})},destroy:function(){this.inherited(arguments)},onRefreshRequested:function(a){c.debug("Refresh UI");this.getSource();this.updateEditorMode()},onMeasure:function(){return this.SIZE}})});
