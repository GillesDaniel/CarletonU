define("dojo/_base/lang dojo/_base/declare com/ibm/tivoli/maximo/miniapps/_MiniApp com/ibm/tivoli/maximo/miniapps/_MaximoIO com/ibm/tivoli/maximo/miniapps/_MaximoLog com/ibm/tivoli/maximo/miniapps/Handlers ibm/miniapp/apptbook/AppointmentsView dojo/date ibm/tivoli/mbs/dijit/DateTimeCalendar dijit/Calendar dijit/popup dojo/dom".split(" "),function(k,m,n,p,d,q,r,u,v,w,x,l){return m([n,p,q,r],{GANTTCOL:"GANTT",gridId:"apptbook",grid:null,projectid:"",constructor:function(b){this.TAG=b.TAG||"APPTBOOK";
b.loglevel&&(d.LOG_LEVEL=b.loglevel);d.debug("{} options",this.TAG,b);this.subscribeOn("apptbook.toolbar.sample",k.hitch(this,this.OnSampleIconClick));this.weatherData=null;window.OnSKDWeatherIconClick=k.hitch(this,this.OnWeatherIconClick)},OnWeatherIconClick:function(b){d.debug("OnWeatherIconClick: "+b);var c=this.getWeatherForDay(b);c&&d.debug("We Clicked on ICON {} for Day: ",b,c)},OnGetGanttHeader:function(b,c,a,t,y,h){var f=this.inherited(arguments);if(0>c.indexOf(".")){var e=this.getWeatherAlertHtml(t);
e&&(f+=e);d.debug("OnGetGanttHeader: {}",f)}return f},getWeatherAlertHtml:function(b){if(!this.options.scheduler_plus_weather_license)d.debug("No Weather License");else if(this.weatherData&&this.weatherData.days){var c=(new Date(b)).toISOString().substr(0,10).trim(),a=this.getWeatherForDay(c);if(a){if(d.debug("Weather Alert: {} ()",b,c,a),null!=a.weatheralert&&"noalert"!=a.weatheralert)return'<span class="WeatherAlert" onclick="OnSKDWeatherIconClick(\''+(new Date(a.date)).toISOString().substr(0,10).trim()+
'\')"><img src="miniapps/common/ac16_alert_weather.png" title="'+a.weatheralert+'"/></span>'}else d.debug("No Weather for Day: {}",c)}},getWeatherForDay:function(b){if(this.weatherData&&this.weatherData.days)for(var c=0;c<this.weatherData.days.length;c++){var a=this.weatherData.days[c];if((new Date(a.date)).toISOString().substr(0,10).trim()==b)return a}},OnRenderFinish:function(b){d.debug("Resizing to Fit");b.ActionZoomFit();this.grid=b;var c=this;this.options.scheduler_plus_weather_license&&this.fetch("load_weather_data",
{}).then(k.hitch(this,function(a){c.weatherData=a;c.weatherData&&c.grid.RefreshGantt(5);var b=null,d=!1;a&&"null_location"==a.status_message&&(d=!0);a&&401==a.status&&(b=c.options.not_authorized);a&&a.error_invalid_locale&&(b=c.options.weather_invalid_locale);a&&400==a.status&&(b=c.options.weather_bad_request);a&&412==a.status&&(b=c.options.weather_no_location);a&&404==a.status&&(b=c.options.weather_out_of_range);if(!a||!a.status||400<a.status)b=c.options.unable_to_fetch;if(b||d){a=new Date;for(var h=
0;7>h;h++){var f=a.toISOString().substr(0,10);if((f=l.byId("date_"+f+".1"))&&!d){var e='<span class="helper"></span><div class="errorHeader"><img src="../images/async/warning.png" title="'+b+'"></div>';f.innerHTML+=e}a.setDate(a.getDate()+1)}}else for(h=0;h<a.days.length;h++)for(b=a.days[h],d=0;d<b.fields.length;d++){var g=b.fields[d],f=(new Date(b.date)).toISOString().substr(0,10);(f=l.byId("date_"+f+"."+(d+1)))&&g.value&&(e="<div",g.style&&(e+=' class="'+g.style+'"'),e+=">",g.suppress_label||(e+=
'<div class="header">'+g.label+"</div>"),e=g.icon?e+('<img src="weather/100x100/'+g.value+'.png">'):e+("<span>"+g.value_formatted+"</span>"),e+="</div>",f.innerHTML+=e)}}))},showNoWeather:function(b,c){d.error("No Weather",c)}})});
